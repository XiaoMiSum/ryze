# ğŸ” æå–å™¨ä½¿ç”¨æŒ‡å—

æå–å™¨æ˜¯ Ryze æ¡†æ¶ä¸­çš„é‡è¦ç»„ä»¶ï¼Œç”¨äºä»å–æ ·å™¨æˆ–å¤„ç†å™¨çš„å“åº”ç»“æœä¸­æå–æ•°æ®ï¼Œå¹¶å°†æå–çš„å€¼å­˜å‚¨ä¸ºå˜é‡ä¾›åç»­ä½¿ç”¨ã€‚

## ğŸ“‹ ç›®å½•

- [åŸºæœ¬æ¦‚å¿µ](#åŸºæœ¬æ¦‚å¿µ)
- [å†…ç½®æå–å™¨](#å†…ç½®æå–å™¨)
- [ä½¿ç”¨åœºæ™¯](#ä½¿ç”¨åœºæ™¯)
- [è‡ªå®šä¹‰æå–å™¨å¼€å‘](#è‡ªå®šä¹‰æå–å™¨å¼€å‘)

## ğŸ” åŸºæœ¬æ¦‚å¿µ

### ä½œç”¨åŸç†

æå–å™¨åœ¨å–æ ·å™¨æˆ–å¤„ç†å™¨æ‰§è¡Œå®Œæˆåè‡ªåŠ¨è¿è¡Œï¼Œä»å“åº”ç»“æœä¸­æå–æŒ‡å®šçš„æ•°æ®ï¼Œå¹¶å°†å…¶å­˜å‚¨ä¸ºå˜é‡ï¼Œä¾›åç»­çš„æµ‹è¯•æ­¥éª¤ä½¿ç”¨ã€‚

### é…ç½®ä½ç½®

æå–å™¨å¯ä»¥é…ç½®åœ¨ï¼š

- **å–æ ·å™¨ä¸­**ï¼šç›´æ¥ä»å–æ ·å™¨çš„å“åº”ä¸­æå–æ•°æ®
- **åç½®å¤„ç†å™¨ä¸­**ï¼šä½œä¸ºåç½®å¤„ç†çš„ä¸€éƒ¨åˆ†
- **æµ‹è¯•é›†åˆä¸­**ï¼šåœ¨é›†åˆçº§åˆ«è¿›è¡Œæ•°æ®æå–

## ğŸ› ï¸ å†…ç½®æå–å™¨

### ğŸ“Š JSON æå–å™¨

ç”¨äºä» JSON æ ¼å¼çš„å“åº”æ•°æ®ä¸­æå–æŒ‡å®šå€¼ã€‚

**é…ç½®å‚æ•°**ï¼š

| å‚æ•° | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| `testclass` | String | æå–å™¨ç±»å‹ï¼Œå¯é€‰å€¼ï¼š`json`ã€`JSONExtractor`ã€`json_extractor` |
| `field` | String | JSONPath è¡¨è¾¾å¼ï¼ˆå¿…å¡«ï¼‰ |
| `variable_name` | String | å˜é‡åç§°ï¼ˆå¿…å¡«ï¼‰ |

**ä½¿ç”¨ç¤ºä¾‹**ï¼š

```yaml
# æ–¹å¼1ï¼šå®Œæ•´é…ç½®
- testclass: json
  field: '$.data.user.id'
  variable_name: user_id

# æ–¹å¼2ï¼šç®€åŒ–é…ç½®
- { testclass: json, field: '$.status', variable_name: api_status }
```

**JSONPath è¡¨è¾¾å¼ç¤ºä¾‹**ï¼š

```json
{
  "status": "success",
  "data": {
    "user": {
      "id": 123,
      "name": "å¼ ä¸‰",
      "roles": ["admin", "user"]
    },
    "pagination": {
      "total": 100,
      "page": 1
    }
  }
}
```

```yaml
extractors:
  - { testclass: json, field: '$.status', variable_name: status }  # æå–: "success"
  - { testclass: json, field: '$.data.user.id', variable_name: user_id }  # æå–: 123
  - { testclass: json, field: '$.data.user.roles[0]', variable_name: first_role }  # æå–: "admin"
  - { testclass: json, field: '$.data.pagination.total', variable_name: total_count }  # æå–: 100
```

### ğŸ” æ­£åˆ™è¡¨è¾¾å¼æå–å™¨

ç”¨äºä» HTMLã€XML æˆ–å…¶ä»–æ–‡æœ¬æ ¼å¼çš„å“åº”ä¸­é€šè¿‡æ­£åˆ™è¡¨è¾¾å¼æå–æ•°æ®ã€‚

**é…ç½®å‚æ•°**ï¼š

| å‚æ•° | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ |
|------|------|--------|------|
| `testclass` | String | æ—  | æå–å™¨ç±»å‹ï¼Œå¯é€‰å€¼ï¼š`regex`ã€`RegexExtractor`ã€`regex_extractor` |
| `field` | String | æ—  | æ­£åˆ™è¡¨è¾¾å¼æ¨¡å¼ï¼ˆå¿…å¡«ï¼‰ |
| `match_num` | Integer | 0 | åŒ¹é…ç»„ç´¢å¼•ï¼ˆ0è¡¨ç¤ºç¬¬ä¸€ä¸ªåŒ¹é…ï¼‰ |
| `variable_name` | String | æ—  | å˜é‡åç§°ï¼ˆå¿…å¡«ï¼‰ |

**ä½¿ç”¨ç¤ºä¾‹**ï¼š

```yaml
# ä» HTML ä¸­æå–é“¾æ¥
extractors:
  - testclass: regex
    field: '<a\\s+href="([^"]+)"'
    match_num: 0
    variable_name: first_link

# æå–æ•°å­—
  - testclass: regex
    field: '\\d+'
    match_num: 1  # ç¬¬äºŒä¸ªåŒ¹é…çš„æ•°å­—
    variable_name: second_number

# ç®€åŒ–é…ç½®
  - { testclass: regex, field: 'error_code:(\\d+)', match_num: 0, variable_name: error_code }
```

**å¸¸ç”¨æ­£åˆ™æ¨¡å¼**ï¼š

- æå–æ•°å­—ï¼š`\\d+`
- æå–é‚®ç®±ï¼š`[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}`
- æå– URLï¼š`https?://[^\\s]+`
- æå– HTML æ ‡ç­¾å†…å®¹ï¼š`<tag[^>]*>([^<]*)</tag>`

### ğŸ“‹ ç»“æœæå–å™¨

å°†æ•´ä¸ªå“åº”ç»“æœä½œä¸ºå˜é‡å€¼ä¿å­˜ã€‚

**é…ç½®å‚æ•°**ï¼š

| å‚æ•° | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| `testclass` | String | æå–å™¨ç±»å‹ï¼Œå¯é€‰å€¼ï¼š`result`ã€`ResultExtractor`ã€`result_extractor` |
| `variable_name` | String | å˜é‡åç§°ï¼ˆå¿…å¡«ï¼‰ |

**ä½¿ç”¨ç¤ºä¾‹**ï¼š

```yaml
extractors:
  # ä¿å­˜å®Œæ•´å“åº”
  - testclass: result
    variable_name: full_response
    
  # ç®€åŒ–é…ç½®
  - { testclass: result, variable_name: api_response }
```

### ğŸŒ HTTP Header æå–å™¨

ä» HTTP å“åº”å¤´ä¸­æå–æŒ‡å®šçš„å¤´ä¿¡æ¯ã€‚

**é…ç½®å‚æ•°**ï¼š

| å‚æ•° | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ |
|------|------|--------|------|
| `testclass` | String | æ—  | æå–å™¨ç±»å‹ï¼Œå¯é€‰å€¼ï¼š`http`ã€`http_header`ã€`HTTPHeader`ã€`HTTPHeaderExtractor` |
| `field` | String | æ—  | å“åº”å¤´åç§°ï¼ˆåŒºåˆ†å¤§å°å†™ï¼Œå¿…å¡«ï¼‰ |
| `match_num` | Integer | 0 | åŒ¹é…ç´¢å¼•ï¼ˆå½“æœ‰å¤šä¸ªåŒåå¤´æ—¶ï¼‰ |
| `ref_name` | String | æ—  | å˜é‡åç§°ï¼ˆå¿…å¡«ï¼‰ |

**ä½¿ç”¨ç¤ºä¾‹**ï¼š

```yaml
extractors:
  # æå– Content-Type
  - testclass: http
    field: 'Content-Type'
    match_num: 0
    ref_name: content_type
    
  # æå–è‡ªå®šä¹‰å¤´
  - testclass: http_header
    field: 'X-Request-ID'
    ref_name: request_id
    
  # ç®€åŒ–é…ç½®
  - { testclass: http, field: 'Set-Cookie', match_num: 0, ref_name: session_cookie }
```

**å¸¸ç”¨ HTTP å¤´ï¼š**

- `Content-Type`ï¼šå“åº”å†…å®¹ç±»å‹
- `Content-Length`ï¼šå“åº”å†…å®¹é•¿åº¦
- `Set-Cookie`ï¼šCookie è®¾ç½®
- `Location`ï¼šé‡å®šå‘åœ°å€
- `X-*`ï¼šè‡ªå®šä¹‰å¤´

## ğŸ”§ ä½¿ç”¨åœºæ™¯

### ğŸ“Š æ•°æ®ä¼ é€’åœºæ™¯

åœ¨å¤šæ­¥éª¤æµ‹è¯•ä¸­ï¼Œä½¿ç”¨æå–å™¨å°†å‰ä¸€æ­¥çš„ç»“æœä¼ é€’ç»™åä¸€æ­¥ï¼š

```yaml
# æ­¥éª¤1ï¼šç™»å½•è·å– token
- title: "ç”¨æˆ·ç™»å½•"
  testclass: http
  config:
    method: POST
    url: https://api.example.com/login
    body:
      username: admin
      password: password123
  extractors:
    # æå–ç™»å½•è¿”å›çš„ token
    - { testclass: json, field: '$.data.token', variable_name: auth_token }
    # æå–ç”¨æˆ·ID
    - { testclass: json, field: '$.data.user.id', variable_name: user_id }

# æ­¥éª¤2ï¼šä½¿ç”¨ token è·å–ç”¨æˆ·ä¿¡æ¯
- title: "è·å–ç”¨æˆ·ä¿¡æ¯"
  testclass: http
  config:
    method: GET
    url: https://api.example.com/user/${user_id}
    headers:
      Authorization: Bearer ${auth_token}
  extractors:
    - { testclass: json, field: '$.data.profile', variable_name: user_profile }
```

### ğŸ”— é“¾å¼æ•°æ®å¤„ç†

ç»„åˆå¤šä¸ªæå–å™¨å¤„ç†å¤æ‚æ•°æ®ï¼š

```yaml
testclass: http
config:
  method: GET
  url: https://api.example.com/products
extractors:
  # æå–å•†å“åˆ—è¡¨
  - { testclass: json, field: '$.data.products', variable_name: product_list }
  # æå–ç¬¬ä¸€ä¸ªå•†å“ID
  - { testclass: json, field: '$.data.products[0].id', variable_name: first_product_id }
  # æå–åˆ†é¡µä¿¡æ¯
  - { testclass: json, field: '$.pagination.total', variable_name: total_products }
  # ä»å“åº”å¤´æå–ç¼“å­˜ä¿¡æ¯
  - { testclass: http, field: 'Cache-Control', ref_name: cache_policy }
```

### ğŸ” æ¡ä»¶æ•°æ®æå–

æ ¹æ®å“åº”å†…å®¹çš„ä¸åŒæƒ…å†µæå–ä¸åŒæ•°æ®ï¼š

```yaml
testclass: http
config:
  method: GET
  url: https://api.example.com/status
extractors:
  # æå–çŠ¶æ€ç 
  - { testclass: json, field: '$.status', variable_name: api_status }
  # æ ¹æ®çŠ¶æ€æå–ä¸åŒä¿¡æ¯
  - testclass: json
    field: '$.data.success_message'  # æˆåŠŸæ—¶çš„æ¶ˆæ¯
    variable_name: success_msg
  - testclass: json
    field: '$.error.message'  # å¤±è´¥æ—¶çš„é”™è¯¯ä¿¡æ¯
    variable_name: error_msg
```

### ğŸ”¢ æ‰¹é‡æ•°æ®å¤„ç†

å¤„ç†æ•°ç»„ç±»å‹çš„å“åº”æ•°æ®ï¼š

```yaml
testclass: http
config:
  method: GET
  url: https://api.example.com/orders
extractors:
  # æå–æ‰€æœ‰è®¢å•ID
  - { testclass: json, field: '$.data[*].id', variable_name: all_order_ids }
  # æå–æœ€æ–°è®¢å•
  - { testclass: json, field: '$.data[0]', variable_name: latest_order }
  # æå–ç‰¹å®šçŠ¶æ€çš„è®¢å•
  - { testclass: json, field: '$.data[?(@.status=="pending")].id', variable_name: pending_orders }
```

## ğŸ’¡ æ‰©å±•åŠŸèƒ½

å½“å†…ç½®æå–å™¨æ— æ³•æ»¡è¶³ç‰¹å®šéœ€æ±‚æ—¶ï¼ŒRyze æ¡†æ¶æ”¯æŒè‡ªå®šä¹‰æå–å™¨æ‰©å±•ã€‚è¯¦ç»†çš„å¼€å‘æŒ‡å—è¯·å‚è€ƒï¼š

- **å¼€å‘æ–‡æ¡£**ï¼š[Development.md](../Development.md) - å®Œæ•´çš„å¼€å‘æŒ‡å—å’Œæœ€ä½³å®è·µ
- **ä»£ç ç¤ºä¾‹**ï¼šæŸ¥çœ‹æ¡†æ¶æºç ä¸­çš„[å†…ç½®æå–å™¨å®ç°](../../ryze/src/main/resources/META-INF/services/io.github.xiaomisum.ryze.core.extractor.Extractor)

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [å˜é‡ä¸å‡½æ•°](./å˜é‡ä¸å‡½æ•°.md) - äº†è§£åŠ¨æ€æ•°æ®ç”Ÿæˆå’Œå¤„ç†
- [éªŒè¯å™¨é…ç½®](./éªŒè¯å™¨.md) - å­¦ä¹ ç»“æœéªŒè¯æŠ€å·§
- [æ‹¦æˆªå™¨æœºåˆ¶](./æ‹¦æˆªå™¨.md) - æŒæ¡è¯·æ±‚å“åº”æ‹¦æˆªå¤„ç†
- [æµ‹è¯•é›†åˆç®¡ç†](./æµ‹è¯•é›†åˆ.md) - ç»„ç»‡å’Œç®¡ç†æµ‹è¯•ç”¨ä¾‹

---

**ğŸ’¡ æç¤º**ï¼šæå–å™¨æ˜¯å®ç°æ•°æ®é©±åŠ¨æµ‹è¯•çš„æ ¸å¿ƒå·¥å…·ï¼Œç†Ÿç»ƒæŒæ¡å„ç§æå–å™¨çš„ä½¿ç”¨å¯ä»¥å¤§å¤§æé«˜æµ‹è¯•çš„çµæ´»æ€§å’Œå¯ç»´æŠ¤æ€§ï¼