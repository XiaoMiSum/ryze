# ğŸ”§ åç½®å¤„ç†å™¨

åç½®å¤„ç†å™¨æ˜¯ Ryze æ¡†æ¶ä¸­åœ¨æµ‹è¯•ç»„ä»¶æ‰§è¡Œåè¿è¡Œçš„ç‰¹æ®Šç»„ä»¶ï¼Œç”¨äºæ‰§è¡Œåå¤„ç†é€»è¾‘ï¼Œå¦‚æ•°æ®æ¸…ç†ã€ç»“æœéªŒè¯ã€é€šçŸ¥å‘é€ç­‰ã€‚

## ğŸ” åŸºæœ¬æ¦‚å¿µ

### ä½œç”¨åŸç†

åç½®å¤„ç†å™¨åœ¨æµ‹è¯•ç»„ä»¶ï¼ˆå–æ ·å™¨ã€æµ‹è¯•é›†åˆç­‰ï¼‰æ‰§è¡Œåè‡ªåŠ¨è¿è¡Œï¼Œå¯ä»¥æ‰§è¡Œå„ç§åå¤„ç†é€»è¾‘ï¼Œå¦‚æ¸…ç†æµ‹è¯•æ•°æ®ã€éªŒè¯ç»“æœã€å‘é€é€šçŸ¥ç­‰ã€‚

### é…ç½®ä½ç½®

åç½®å¤„ç†å™¨å¯ä»¥é…ç½®åœ¨ï¼š

- **æµ‹è¯•é›†åˆä¸­**ï¼šåœ¨æµ‹è¯•é›†åˆæ‰§è¡Œåè¿è¡Œ
- **å–æ ·å™¨ä¸­**ï¼šåœ¨å–æ ·å™¨æ‰§è¡Œåè¿è¡Œ
- **æ¨¡å—çº§é›†åˆ**ï¼šåœ¨æ¨¡å—æµ‹è¯•åè¿è¡Œ
- **é¡¹ç›®çº§é›†åˆ**ï¼šåœ¨æ•´ä¸ªé¡¹ç›®æµ‹è¯•åè¿è¡Œ

## ğŸ¯ è®¾è®¡ç†å¿µ

### æµ‹è¯•æ¸…ç†è‡ªåŠ¨åŒ–

åç½®å¤„ç†å™¨çš„è®¾è®¡ç†å¿µæ˜¯å®ç°æµ‹è¯•æ¸…ç†å’Œç»“æœå¤„ç†çš„è‡ªåŠ¨åŒ–ï¼š

- **æ•°æ®æ¸…ç†**ï¼šè‡ªåŠ¨æ¸…ç†æµ‹è¯•äº§ç”Ÿçš„ä¸´æ—¶æ•°æ®
- **ç»“æœéªŒè¯**ï¼šå¯¹æµ‹è¯•ç»“æœè¿›è¡Œé¢å¤–çš„éªŒè¯
- **çŠ¶æ€æ¢å¤**ï¼šå°†æµ‹è¯•ç¯å¢ƒæ¢å¤åˆ°åˆå§‹çŠ¶æ€
- **é€šçŸ¥å‘é€**ï¼šå‘é€æµ‹è¯•ç»“æœé€šçŸ¥

### åè®®æ— å…³æ€§

åç½®å¤„ç†å™¨è®¾è®¡ä¸ºåè®®æ— å…³çš„ç»„ä»¶ï¼Œä¸åŒåè®®çš„åç½®å¤„ç†å™¨å…·æœ‰ç›¸ä¼¼çš„ç»“æ„å’Œä½¿ç”¨æ–¹å¼ï¼š

```yaml
# é€šç”¨åç½®å¤„ç†å™¨ç»“æ„
- testclass: åè®®ç±»å‹
  config:
    # åè®®ç‰¹å®šé…ç½®é¡¹
```

## â±ï¸ æ‰§è¡Œæ—¶æœº

### æ‰§è¡Œé¡ºåº

åç½®å¤„ç†å™¨éµå¾ªä¸¥æ ¼çš„æ‰§è¡Œé¡ºåºï¼ˆä¸å‰ç½®å¤„ç†å™¨ç›¸åï¼‰ï¼š

1. **å–æ ·å™¨çº§åç½®å¤„ç†å™¨**ï¼šæœ€å…ˆæ‰§è¡Œ
2. **é›†åˆçº§åç½®å¤„ç†å™¨**ï¼šå…¶æ¬¡æ‰§è¡Œ
3. **æ¨¡å—çº§åç½®å¤„ç†å™¨**ï¼šç„¶åæ‰§è¡Œ
4. **é¡¹ç›®çº§åç½®å¤„ç†å™¨**ï¼šæœ€åæ‰§è¡Œ

### æ‰§è¡Œä¸Šä¸‹æ–‡

åç½®å¤„ç†å™¨åœ¨æ‰§è¡Œæ—¶å…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š

- **å˜é‡è®¿é—®**ï¼šå¯ä»¥è®¿é—®æµ‹è¯•è¿‡ç¨‹ä¸­ç”Ÿæˆçš„å˜é‡
- **ç»“æœè®¿é—®**ï¼šå¯ä»¥è®¿é—®æµ‹è¯•ç»„ä»¶çš„æ‰§è¡Œç»“æœ
- **é…ç½®ç»§æ‰¿**ï¼šå¯ä»¥ç»§æ‰¿é…ç½®å…ƒä»¶çš„é…ç½®

```yaml
title: æµ‹è¯•é›†åˆ
variables:
  user_id: 12345

children:
  - title: ç”¨æˆ·æ“ä½œæµ‹è¯•
    children:
      - testclass: http
        config:
          method: POST
          path: /users
          body:
            name: Test User
        extractors:
          # æå–æ–°åˆ›å»ºçš„ç”¨æˆ·ID
          - { testclass: json, field: '$.data.id', ref_name: new_user_id }
        # å–æ ·å™¨çº§åç½®å¤„ç†å™¨
        postprocessors:
          - testclass: http
            config:
              method: POST
              path: /notifications
              body:
                message: "User ${new_user_id} created"
    
    # é›†åˆçº§åç½®å¤„ç†å™¨
    postprocessors:
      - testclass: http
        config:
          method: DELETE
          path: /users/${new_user_id}
        # æ¸…ç†æµ‹è¯•æ•°æ®

# æ¨¡å—çº§åç½®å¤„ç†å™¨
postprocessors:
  - testclass: jdbc
    config:
      sql: "DELETE FROM audit_logs WHERE user_id = ${user_id}"

# é¡¹ç›®çº§åç½®å¤„ç†å™¨
postprocessors:
  - testclass: http
    config:
      method: POST
      path: /reports
      body:
        test_suite: "User Operations"
        status: "completed"
```

## ğŸŒ å„åè®®åç½®å¤„ç†å™¨

### ğŸŒ HTTP åç½®å¤„ç†å™¨

ç”¨äºæ‰§è¡Œ HTTP è¯·æ±‚ä½œä¸ºåå¤„ç†é€»è¾‘ã€‚

**é…ç½®æ¨¡æ¿**ï¼š[http_postprocessor.yaml](../template/å¤„ç†å™¨/http_postprocessor.yaml)

```yaml
- testclass: http
  config:
    method: post
    protocol: http
    http/2: false
    port: 8080
    host: localhost
    path: /user
    headers:
      h1: 1
    query: { }
    data: { }
    body: { userName: 'ryze', password: '123456qq' }
```

**ç›¸å…³æ–‡æ¡£**ï¼š[HTTP åè®®æ–‡æ¡£](../protocols/HTTP.md#åç½®å¤„ç†å™¨)

### ğŸ—„ï¸ JDBC åç½®å¤„ç†å™¨

ç”¨äºæ‰§è¡Œæ•°æ®åº“æ“ä½œä½œä¸ºåå¤„ç†é€»è¾‘ã€‚

**é…ç½®æ¨¡æ¿**ï¼š[jdbc_postprocessor.yaml](../template/å¤„ç†å™¨/jdbc_postprocessor.yaml)

```yaml
- testclass: jdbc
  config:
    sql: "DELETE FROM users WHERE name = 'testuser'"
```

**ç›¸å…³æ–‡æ¡£**ï¼š[JDBC åè®®æ–‡æ¡£](../protocols/JDBC.md#å¤„ç†å™¨)

### ğŸ—ƒï¸ Redis åç½®å¤„ç†å™¨

ç”¨äºæ‰§è¡Œ Redis æ“ä½œä½œä¸ºåå¤„ç†é€»è¾‘ã€‚

**é…ç½®æ¨¡æ¿**ï¼š[redis_postprocessor.yaml](../template/å¤„ç†å™¨/redis_postprocessor.yaml)

```yaml
- testclass: redis
  config:
    command: DEL
    key: test_key
```

**ç›¸å…³æ–‡æ¡£**ï¼š[Redis åè®®æ–‡æ¡£](../protocols/Redis.md#å¤„ç†å™¨)

### ğŸ”Œ Dubbo åç½®å¤„ç†å™¨

ç”¨äºæ‰§è¡Œ Dubbo æœåŠ¡è°ƒç”¨ä½œä¸ºåå¤„ç†é€»è¾‘ã€‚

**é…ç½®æ¨¡æ¿**ï¼š[dubbo_postprocessor.yaml](../template/å¤„ç†å™¨/dubbo_postprocessor.yaml)

```yaml
- testclass: dubbo
  config:
    interface: com.example.UserService
    method: deleteUser
    parameters:
      - 12345
```

**ç›¸å…³æ–‡æ¡£**ï¼š[Dubbo åè®®æ–‡æ¡£](../protocols/Dubbo.md#å¤„ç†å™¨)

### ğŸš€ Kafka åç½®å¤„ç†å™¨

ç”¨äºå‘é€ Kafka æ¶ˆæ¯ä½œä¸ºåå¤„ç†é€»è¾‘ã€‚

**é…ç½®æ¨¡æ¿**ï¼š[kafka_postprocessor.yaml](../template/å¤„ç†å™¨/kafka_postprocessor.yaml)

```yaml
- testclass: kafka
  config:
    topic: user-events
    key: user-deleted
    value: '{"userId": 12345, "action": "delete"}'
```

**ç›¸å…³æ–‡æ¡£**ï¼š[Kafka åè®®æ–‡æ¡£](../protocols/Kafka.md#å¤„ç†å™¨)

### ğŸ° RabbitMQ åç½®å¤„ç†å™¨

ç”¨äºå‘é€ RabbitMQ æ¶ˆæ¯ä½œä¸ºåå¤„ç†é€»è¾‘ã€‚

**é…ç½®æ¨¡æ¿**ï¼š[rabbit_postprocessor.yaml](../template/å¤„ç†å™¨/rabbit_postprocessor.yaml)

```yaml
- testclass: rabbit
  config:
    exchange: user-exchange
    routing_key: user.deleted
    message: '{"userId": 12345, "timestamp": "${timestamp()}"}'
```

**ç›¸å…³æ–‡æ¡£**ï¼š[RabbitMQ åè®®æ–‡æ¡£](../protocols/RabbitMQ.md#å¤„ç†å™¨)

### ğŸ¯ ActiveMQ åç½®å¤„ç†å™¨

ç”¨äºå‘é€ ActiveMQ æ¶ˆæ¯ä½œä¸ºåå¤„ç†é€»è¾‘ã€‚

**é…ç½®æ¨¡æ¿**ï¼š[active_postprocessor.yaml](../template/å¤„ç†å™¨/active_postprocessor.yaml)

```yaml
- testclass: active
  config:
    destination: user-queue
    message: '{"userId": 12345, "action": "delete"}'
```

**ç›¸å…³æ–‡æ¡£**ï¼š[ActiveMQ åè®®æ–‡æ¡£](../protocols/ActiveMQ.md#å¤„ç†å™¨)

### ğŸƒ MongoDB åç½®å¤„ç†å™¨

ç”¨äºæ‰§è¡Œ MongoDB æ“ä½œä½œä¸ºåå¤„ç†é€»è¾‘ã€‚

**é…ç½®æ¨¡æ¿**ï¼š[mongo_postprocessor.yaml](../template/å¤„ç†å™¨/mongo_postprocessor.yaml)

```yaml
- testclass: mongo
  config:
    operation: delete
    collection: users
    filter: '{"name": "testuser"}'
```

**ç›¸å…³æ–‡æ¡£**ï¼š[MongoDB åè®®æ–‡æ¡£](../protocols/MongoDB.md#å¤„ç†å™¨)

## ğŸ”§ ä½¿ç”¨åœºæ™¯

### æµ‹è¯•æ•°æ®æ¸…ç†

åœ¨æµ‹è¯•åæ¸…ç†äº§ç”Ÿçš„æµ‹è¯•æ•°æ®ï¼š

```yaml
title: ç”¨æˆ·ç®¡ç†æµ‹è¯•
children:
  - testclass: http
    config:
      method: POST
      path: /users
      body:
        name: Test User
        email: test@example.com
    extractors:
      - { testclass: json, field: '$.data.id', ref_name: user_id }
    postprocessors:
      # æµ‹è¯•åæ¸…ç†åˆ›å»ºçš„ç”¨æˆ·
      - testclass: http
        config:
          method: DELETE
          path: /users/${user_id}

postprocessors:
  # é›†åˆçº§æ¸…ç†ï¼šæ¸…ç†æ‰€æœ‰æµ‹è¯•ç”¨æˆ·
  - testclass: jdbc
    config:
      sql: "DELETE FROM users WHERE name LIKE 'Test User%'"
```

### ç»“æœéªŒè¯å’ŒæŠ¥å‘Š

åœ¨æµ‹è¯•åè¿›è¡Œé¢å¤–çš„ç»“æœéªŒè¯å’ŒæŠ¥å‘Šç”Ÿæˆï¼š

```yaml
title: è®¢å•å¤„ç†æµ‹è¯•
children:
  - testclass: http
    config:
      method: POST
      path: /orders
      body:
        product_id: 12345
        quantity: 2
    extractors:
      - { testclass: json, field: '$.data.order_id', ref_name: order_id }
    postprocessors:
      # éªŒè¯è®¢å•çŠ¶æ€
      - testclass: http
        config:
          method: GET
          path: /orders/${order_id}
        assertions:
          - { testclass: json, field: '$.data.status', expected: 'processed', rule: '==' }
      
      # å‘é€æµ‹è¯•ç»“æœé€šçŸ¥
      - testclass: http
        config:
          method: POST
          path: /notifications
          body:
            type: 'test_result'
            message: "Order ${order_id} processed successfully"
```

### çŠ¶æ€æ¢å¤

åœ¨æµ‹è¯•åå°†ç³»ç»ŸçŠ¶æ€æ¢å¤åˆ°åˆå§‹çŠ¶æ€ï¼š

```yaml
title: åº“å­˜ç®¡ç†æµ‹è¯•
preprocessors:
  # ä¿å­˜åˆå§‹åº“å­˜çŠ¶æ€
  - testclass: jdbc
    config:
      sql: "SELECT quantity FROM inventory WHERE product_id = 'PRODUCT_001'"
    extractors:
      - { testclass: result, ref_name: initial_quantity }

children:
  - testclass: http
    config:
      method: PUT
      path: /inventory/PRODUCT_001
      body:
        quantity: 0  # æ‰£å‡åº“å­˜åˆ°0

postprocessors:
  # æ¢å¤åˆå§‹åº“å­˜çŠ¶æ€
  - testclass: jdbc
    config:
      sql: "UPDATE inventory SET quantity = ${initial_quantity} WHERE product_id = 'PRODUCT_001'"
```

### æ—¥å¿—è®°å½•å’Œå®¡è®¡

åœ¨æµ‹è¯•åè®°å½•æ“ä½œæ—¥å¿—å’Œå®¡è®¡ä¿¡æ¯ï¼š

```yaml
title: ç”¨æˆ·æƒé™æµ‹è¯•
variables:
  test_start_time: ${timestamp()}

children:
  - testclass: http
    config:
      method: PUT
      path: /users/${user_id}/permissions
      body:
        role: admin
    postprocessors:
      # è®°å½•æƒé™å˜æ›´æ—¥å¿—
      - testclass: jdbc
        config:
          sql: |
            INSERT INTO audit_logs (user_id, action, timestamp, details) 
            VALUES (?, ?, ?, ?)
          parameters:
            - ${user_id}
            - 'permission_change'
            - ${timestamp()}
            - 'Changed role to admin'

postprocessors:
  # è®°å½•æµ‹è¯•å®Œæˆæ—¥å¿—
  - testclass: jdbc
    config:
      sql: |
        INSERT INTO test_logs (test_name, start_time, end_time, status) 
        VALUES (?, ?, ?, ?)
      parameters:
        - "User Permission Test"
        - ${test_start_time}
        - ${timestamp()}
        - "completed"
```

## ğŸ“š æœ€ä½³å®è·µ

### å¤„ç†å™¨åˆ†å±‚åŸåˆ™

#### é¡¹ç›®çº§å¤„ç†å™¨

- **å…¨å±€æ¸…ç†**ï¼šæ•´ä¸ªé¡¹ç›®çš„é€šç”¨æ¸…ç†é€»è¾‘
- **æŠ¥å‘Šç”Ÿæˆ**ï¼šç”Ÿæˆé¡¹ç›®çº§çš„æµ‹è¯•æŠ¥å‘Š
- **çŠ¶æ€é‡ç½®**ï¼šå°†æ•´ä¸ªæµ‹è¯•ç¯å¢ƒé‡ç½®åˆ°åˆå§‹çŠ¶æ€

#### æ¨¡å—çº§å¤„ç†å™¨

- **æ¨¡å—æ¸…ç†**ï¼šç‰¹å®šæ¨¡å—çš„æ¸…ç†å·¥ä½œ
- **æ•°æ®å½’æ¡£**ï¼šå½’æ¡£æ¨¡å—çš„æµ‹è¯•æ•°æ®
- **æœåŠ¡é‡ç½®**ï¼šé‡ç½®æ¨¡å—ä¾èµ–çš„æœåŠ¡çŠ¶æ€

#### ç”¨ä¾‹çº§å¤„ç†å™¨

- **ç”¨ä¾‹æ¸…ç†**ï¼šå½“å‰ç”¨ä¾‹ç‰¹å®šçš„æ¸…ç†å·¥ä½œ
- **ç»“æœè®°å½•**ï¼šè®°å½•ç”¨ä¾‹çš„æ‰§è¡Œç»“æœ
- **èµ„æºé‡Šæ”¾**ï¼šé‡Šæ”¾ç”¨ä¾‹ä½¿ç”¨çš„èµ„æº

### é”™è¯¯å¤„ç†

#### å¼‚å¸¸å®¹å¿

åç½®å¤„ç†å™¨é€šå¸¸åº”è¯¥å®¹å¿å¼‚å¸¸ï¼Œç¡®ä¿å³ä½¿åç½®å¤„ç†å¤±è´¥ä¹Ÿä¸ä¼šå½±å“æµ‹è¯•ç»“æœï¼š

```yaml
postprocessors:
  - testclass: http
    config:
      method: DELETE
      path: /users/${user_id}
    # å³ä½¿æ¸…ç†å¤±è´¥ï¼Œä¹Ÿä¸å½±å“æµ‹è¯•ç»“æœ
    ignore_errors: true
```

#### æ¡ä»¶æ‰§è¡Œ

æ ¹æ®æµ‹è¯•ç»“æœå†³å®šæ˜¯å¦æ‰§è¡Œåç½®å¤„ç†ï¼š

```yaml
postprocessors:
  - testclass: http
    # ä»…åœ¨æµ‹è¯•æˆåŠŸæ—¶æ‰§è¡Œæ¸…ç†
    condition: ${test_result == 'success'}
    config:
      method: DELETE
      path: /users/${user_id}
  
  - testclass: http
    # ä»…åœ¨æµ‹è¯•å¤±è´¥æ—¶å‘é€å‘Šè­¦
    condition: ${test_result == 'failed'}
    config:
      method: POST
      path: /alerts
      body:
        message: "Test failed, manual cleanup required"
```

### æ€§èƒ½ä¼˜åŒ–

#### å¼‚æ­¥å¤„ç†

å¯¹äºä¸å½±å“æµ‹è¯•ç»“æœçš„åç½®å¤„ç†ï¼Œå¯ä»¥è€ƒè™‘å¼‚æ­¥æ‰§è¡Œï¼š

```yaml
postprocessors:
  - testclass: http
    async: true  # å¼‚æ­¥æ‰§è¡Œ
    config:
      method: POST
      path: /reports
      body:
        test_name: "User Management Test"
        duration: ${test_duration}
```

#### æ‰¹é‡æ“ä½œ

å°†å¤šä¸ªç›¸ä¼¼çš„åç½®å¤„ç†åˆå¹¶ä¸ºæ‰¹é‡æ“ä½œï¼š

```yaml
postprocessors:
  - testclass: jdbc
    config:
      sql: |
        DELETE FROM users WHERE id IN (${user_ids});
        DELETE FROM orders WHERE user_id IN (${user_ids});
        DELETE FROM audit_logs WHERE user_id IN (${user_ids});
```

### å¯ç»´æŠ¤æ€§

#### é…ç½®åˆ†ç¦»

å°†å¤æ‚çš„åç½®å¤„ç†é…ç½®åˆ†ç¦»åˆ°ç‹¬ç«‹çš„é…ç½®æ–‡ä»¶ä¸­ï¼š

```yaml
# åœ¨å•ç‹¬çš„é…ç½®æ–‡ä»¶ä¸­å®šä¹‰å¤æ‚çš„å¤„ç†å™¨
postprocessors:
  - !include 'processors/cleanup_test_data.yaml'
  - !include 'processors/generate_test_report.yaml'
```

#### æ¨¡å—åŒ–è®¾è®¡

å°†ç›¸å…³çš„åç½®å¤„ç†é€»è¾‘ç»„ç»‡æˆæ¨¡å—ï¼š

```yaml
postprocessors:
  # æ•°æ®æ¸…ç†æ¨¡å—
  - !include 'processors/data_cleanup.yaml'
  # æŠ¥å‘Šç”Ÿæˆæ¨¡å—
  - !include 'processors/report_generation.yaml'
```

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [æµ‹è¯•é›†åˆç®¡ç†](./æµ‹è¯•é›†åˆ.md) - äº†è§£æµ‹è¯•é›†åˆçš„ç»„ç»‡å’Œç®¡ç†
- [é…ç½®å…ƒä»¶](./é…ç½®å…ƒä»¶.md) - å­¦ä¹ åŸºç¡€é…ç½®ç®¡ç†
- [å‰ç½®å¤„ç†å™¨](./å‰ç½®å¤„ç†å™¨.md) - æŒæ¡æµ‹è¯•å‰çš„é¢„å¤„ç†æœºåˆ¶
- [å–æ ·å™¨](./å–æ ·å™¨.md) - äº†è§£å„ç§åè®®çš„å–æ ·å™¨ä½¿ç”¨

### åè®®æ–‡æ¡£

- [HTTP åè®®](../protocols/HTTP.md#å¤„ç†å™¨) - HTTP å¤„ç†å™¨è¯¦ç»†è¯´æ˜
- [JDBC åè®®](../protocols/JDBC.md#å¤„ç†å™¨) - æ•°æ®åº“å¤„ç†å™¨è¯¦ç»†è¯´æ˜
- [Redis åè®®](../protocols/Redis.md#å¤„ç†å™¨) - Redis å¤„ç†å™¨è¯¦ç»†è¯´æ˜
- [Dubbo åè®®](../protocols/Dubbo.md#å¤„ç†å™¨) - Dubbo å¤„ç†å™¨è¯¦ç»†è¯´æ˜
- [Kafka åè®®](../protocols/Kafka.md#å¤„ç†å™¨) - Kafka å¤„ç†å™¨è¯¦ç»†è¯´æ˜
- [RabbitMQ åè®®](../protocols/RabbitMQ.md#å¤„ç†å™¨) - RabbitMQ å¤„ç†å™¨è¯¦ç»†è¯´æ˜
- [ActiveMQ åè®®](../protocols/ActiveMQ.md#å¤„ç†å™¨) - ActiveMQ å¤„ç†å™¨è¯¦ç»†è¯´æ˜
- [MongoDB åè®®](../protocols/MongoDB.md#å¤„ç†å™¨) - MongoDB å¤„ç†å™¨è¯¦ç»†è¯´æ˜

---

**ğŸ’¡ æç¤º**ï¼šåç½®å¤„ç†å™¨æ˜¯ç¡®ä¿æµ‹è¯•ç¯å¢ƒæ¸…æ´å’Œç»“æœå¯é çš„é‡è¦å·¥å…·ï¼Œåˆç†ä½¿ç”¨å¯ä»¥æ˜¾è‘—æé«˜æµ‹è¯•çš„è‡ªåŠ¨åŒ–ç¨‹åº¦ï¼